<!DOCTYPE HTML>
<!--
	Helios by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<!-- CSS goes in the document HEAD or added to your external stylesheet -->
		<style type="text/css">
			table.hovertable {
				font-family: verdana,arial,sans-serif;
				font-size:20px;
				color:#333333;
				border-width: 1px;
				border-color: #999999;
				border-collapse: collapse;
			}
			table.hovertable th {
				background-color:#df7366;
				border-width: 1px;
				padding: 8px;
				border-style: solid;
				border-color: #a9c6c9;
			}
			table.hovertable tr {
				background-color:#ffffff;
			}
			table.hovertable td {
				border-width: 1px;
				padding: 8px;
				border-style: solid;
				border-color: #a9c6c9;
			}
		</style>
		<title>文本聚类-Caseward-NLP</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="static/assets/css/main.css" />
		<noscript><link rel="stylesheet" href="static/assets/css/noscript.css" /></noscript>
	</head>
	<body class="no-sidebar is-preload">
		<div id="page-wrapper">

			<!-- Header -->
				<div id="header">

					<!-- Inner -->
						<div class="inner">
							<header>
								<h1><a href="cluster" id="logo">文本聚类</a></h1>
								<p><a href="index" id="logo">Caseward-NLP</a></p>
							</header>
						</div>

					<!-- Nav -->
						<nav id="nav">
							<ul>
								<li><a href="cluster">文本聚类</a></li>
								<li>
									<a href="sentiment_analysis">情感分析</a>
								</li>
								<!-- <li><a href="classify">文本分类</a></li> -->
								<li><a href="word_property">词性标注</a></li>
								<li><a href="keyword">关键词标注</a></li>
								<li><a>其他</a></li>
							</ul>
						</nav>

				</div>
			
			<!--添加文本内容-->
			<div>
				<div class="container">
					<div class="row" style="margin-bottom:30px">
							<textarea id="textbody"  style = "margin-left:50px; margin-top: 80px;width:75%;border-radius: 0.5em;" rows="2" placeholder="请输入待聚类的句子"></textarea>
						<div>
							<button id ="cluster-button" style = "margin-left:40px;font-size: 20px; margin-top: 60px;">添加</button>
						</div>
					</div>
				</div>
				
				<div class="container" style="height:290px;display:block;overflow-y:auto;">
					<!-- Table goes in the document BODY -->
					<table class="hovertable" id="forCluster">
						<tr>
							<th style="width:10%">序号</th><th>文本内容</th>
						</tr>
						<!-- <tr onmouseover="this.style.backgroundColor='#ffff66';" onmouseout="this.style.backgroundColor='#ffffff';">
							<td style="text-align: center">1</td><td>Item 1B</td>
						</tr> -->
					</table>
						
				</div>
				<div class="container" style="margin-top:20px;">
					<button id="cluster-run">执行聚类</button>
				</div>
			</div>

			<!--显示统计结果-->
			<div>
				<div class="container" style="margin-top: 30px;">
					<p>聚类结果统计</p>
				</div>
				<div class="container">
					<div id="container" style="height: 400px;"></div>
					
				</div>
			</div>

			<!--显示具体聚类结果-->
			<div>
				<div class="container" style="margin-top: 30px;">
					<p>具体聚类结果</p>
				</div>
				<div class="container" style="height:290px;display:block;overflow-y:auto;margin-bottom: 30px;">
					<!-- Table goes in the document BODY -->
					<table class="hovertable" id="clusterResult">
						<tr>
							<th style="width:10%">序号</th><th style="width:10%">文本类别号</th><th>文本内容</th>
						</tr>
					</table>	
				</div>
			</div>

			<!-- bottom nav -->
			<div class="wrapper style1">
				<!-- Carousel -->
				<section class="carousel">
					<div class="reel">

						<article>
							<a href="cluster" class="image featured"><img src="static/images/01.jpg" alt="" /></a>
							<header>
								<h3><a href="cluster">文本聚类</a></h3>
							</header>
							<p>这是一个提供文本聚类功能的模块。</p>
						</article>

						<article>
							<a href="sentiment_analysis" class="image featured"><img src="static/images/02.jpg" alt="" /></a>
							<header>
								<h3><a href="sentiment_analysis">情感分析</a></h3>
							</header>
							<p>这是一个提供情感分析功能的模块。</p>
						</article>

						<!-- <article>
							<a href="classify" class="image featured"><img src="static/images/03.jpg" alt="" /></a>
							<header>
								<h3><a href="classify">文本分类</a></h3>
							</header>
							<p>这是一个提供文本分类功能的模块。</p>
						</article> -->

						<article>
							<a href="word_property" class="image featured"><img src="static/images/04.jpg" alt="" /></a>
							<header>
								<h3><a href="word_property">词性标注</a></h3>
							</header>
							<p>这是一个提供词性标注功能的模块。</p>
						</article>

						<article>
							<a href="keyword" class="image featured"><img src="static/images/05.jpg" alt="" /></a>
							<header>
								<h3><a href="keyword">关键词提取</a></h3>
							</header>
							<p>这是提供关键词提取功能的模块。</p>
						</article>

						<article>
							<a  class="image featured"><img src="static/images/06.jpg" alt="" /></a>
							<header>
								<h3><a >其他</a></h3>
							</header>
							<p>这是一个提供其他功能的模块。</p>
						</article>


					</div>
				</section>
			</div>

			<!-- Footer -->
				<div id="footer">
					<div class="container">
						<div class="row">
							<div class="col-12">

								<!-- Contact -->
									<section class="contact">
										<header>
											<h3>Caseward-NLP</h3>
										</header>
										<p>这是一个自然语言处理的试验平台。</p>
										<ul class="icons">
											<li><a href="#" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
											<li><a href="#" class="icon fa-facebook"><span class="label">Facebook</span></a></li>
											<li><a href="#" class="icon fa-instagram"><span class="label">Instagram</span></a></li>
											<li><a href="#" class="icon fa-pinterest"><span class="label">Pinterest</span></a></li>
											<li><a href="#" class="icon fa-dribbble"><span class="label">Dribbble</span></a></li>
											<li><a href="#" class="icon fa-linkedin"><span class="label">Linkedin</span></a></li>
										</ul>
									</section>

								<!-- Copyright -->
									<div class="copyright">
										<ul class="menu">
											<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
										</ul>
									</div>

							</div>

						</div>
					</div>
				</div>

		</div>

		<!-- Scripts -->
			<script src="static/assets/js/jquery.min.js"></script>
			<script src="static/assets/js/jquery.dropotron.min.js"></script>
			<script src="static/assets/js/jquery.scrolly.min.js"></script>
			<script src="static/assets/js/jquery.scrollex.min.js"></script>
			<script src="static/assets/js/browser.min.js"></script>
			<script src="static/assets/js/breakpoints.min.js"></script>
			<script src="static/assets/js/util.js"></script>
			<script src="static/assets/js/main.js"></script>
			<script src="static/assets/js/echarts.js"></script>
			<script>
				var textNum = 1;
				var textDict = new Array();
				$(document).ready(function(){
					$('#textbody').on('input propertychange', function(){
						var theText = $(this).val();
						allText = theText;
						$('#textbody').html(allText);
					});
				});
				$('#cluster-button').click(function(){
					var data={'sentence':$('#textbody').text()};
					var addText=data['sentence'];
					console.log(data);
					var currentRows = document.getElementById("forCluster").rows.length;
					console.log(currentRows);
					var insertTr = document.getElementById("forCluster").insertRow(currentRows);
					var insertTd = insertTr.insertCell(0);
					insertTd.style.textAlign="center";
					insertTd.innerHTML = currentRows;

					insertTd = insertTr.insertCell(1);
					// insertTr.onmouseover="this.style.backgroundColor='#ffff66';";
					// insertTr.onmouseout="this.style.backgroundColor='#ffffff';";
					//insertTd.style.textAlign="center";
					insertTd.innerHTML = addText;

					textDict[currentRows-1]=addText;
					console.log(textDict);
				});
	
				$('#cluster-run').click(function(){
					console.log(textDict);
					var clusterData={'textDict':JSON.stringify(textDict)};
					console.log(clusterData);
					$.ajax({
						url:"/cluster/get_result",
						type:'get',
						data:clusterData,
						success:function(clusterResult){
							var tb = document.getElementById('clusterResult');
						    var rowNum=tb.rows.length;
						    for (i=1;i<rowNum;i++)
						    {
						        tb.deleteRow(i);
						        rowNum=rowNum-1;
						        i=i-1;
						    }
							console.log(clusterResult);
							var txtCount = Object.keys(clusterResult[0]).length;
							for(i=0;i<txtCount;i++){
								var currentRows = document.getElementById("clusterResult").rows.length;
								console.log(currentRows);
								var insertTr = document.getElementById("clusterResult").insertRow(currentRows);
								var insertTd = insertTr.insertCell(0);
								insertTd.style.textAlign="center";
								insertTd.innerHTML = currentRows;
								console.log(clusterResult[0][i]);

								insertTd = insertTr.insertCell(1);
								// insertTr.onmouseover="this.style.backgroundColor='#ffff66';";
								// insertTr.onmouseout="this.style.backgroundColor='#ffffff';";
								//insertTd.style.textAlign="center";
								insertTd.innerHTML = clusterResult[0][i]['lei'];

								insertTd = insertTr.insertCell(2);
								insertTd.innerHTML = clusterResult[0][i]['content'];
							}
							var dom = document.getElementById("container");
							var myChart = echarts.init(dom);
							var app = {};
							option = null;		
							option = {
								title: {
									text: '聚类结果统计',
									//subtext: '虚构数据',
									left: 'center'
								},
								tooltip : {
									trigger: 'item',
									formatter: "{a} <br/>{b} : {c} ({d}%)"
								},
								legend: {
									// orient: 'vertical',
									// top: 'middle',
									bottom: 10,
									left: 'center',
									data: ['类别1', '类别2','类别3']
								},
								series : [
									{
										type: 'pie',
										radius : '65%',
										center: ['50%', '50%'],
										selectedMode: 'single',
										data:[
											{value:clusterResult[1]['leiOne'], name: '类别1'},
											{value:clusterResult[1]['leiTwo'], name: '类别2'},
											{value:clusterResult[1]['leiThree'], name: '类别3'}
										],
										itemStyle: {
											emphasis: {
												shadowBlur: 10,
												shadowOffsetX: 0,
												shadowColor: 'rgba(0, 0, 0, 0.5)'
											}
										}
									}
								]
							};
							;
							if (option && typeof option === "object") {
								myChart.setOption(option, true);
							}
									}
								});
							});
			</script>

			<script type="text/javascript">
				
			</script>
	</body>
</html>